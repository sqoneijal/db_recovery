"use strict";(self.webpackChunkdb_recovery=self.webpackChunkdb_recovery||[]).push([[51],{51:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var n=a(8152),s=a(7294),o=a(7027),c=a(9797),r=s.lazy((function(){return a.e(809).then(a.bind(a,809))}));const u=function(e){var t=e.openFormsBackup,a=e.setOpenFormsBackup,u=e.detailContent,i=e.setDetailContent,l=(0,s.useState)(!0),d=(0,n.Z)(l,2),p=d[0],f=d[1],b=(0,s.useState)(!0),m=(0,n.Z)(b,2),h=m[0],v=m[1],g=(0,s.useState)(!1),k=(0,n.Z)(g,2),w=k[0],E=k[1],Z=(0,s.useState)([]),B=(0,n.Z)(Z,2),C=B[0],S=B[1],L=(0,s.useState)([]),_=(0,n.Z)(L,2),y=_[0],j=_[1],F=(0,s.useState)({}),O=(0,n.Z)(F,2),T=O[0],x=O[1];(0,s.useEffect)((function(){return c.objLength(u)&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(!0),c.post("/connecttodb",e,{},!0).then((function(e){var t=e.data;S(t)})).catch((function(e){c.notification(!1,c.error_code_http(e.response.status),e.code)})).then((function(){f(!1)}))}(u),function(){}}),[u]);var z=function(e){return C.findIndex((function(t){return t.tablename===e}))},D=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(void 0!==y[t]){E(!0);var n={hostname:u.hostname,username:u.username,password:u.password,database:u.database,dbdriver:u.dbdriver,port:u.port,tablename:y[t],page:a,total_row:C[z(y[t])].count};c.post("/handlebackup",n,{},!0).then((function(n){var s=n.data;if(s.status)if(s.next_row)x({tablename:y[t],progress:(5e3*a/C[z(y[t])].count*100).toFixed(0)}),e(t,a+1);else{var o=[];C.map((function(e){e.tablename===y[t]?o.push(Object.assign(e,{status:"complete"})):o.push(e)})),S(o),e(t+1,0)}else{var r=[];C.map((function(e){e.tablename===y[t]?r.push(Object.assign(e,{status:"fail"})):r.push(e)})),S(r),e(t+1,0),c.notification(!1,s.msg_response)}})).catch((function(n){e(t,a)}))}else x({}),E(!1),j([]),c.notification(!0,"Backup database selesai dilakukan.")},H={isLoadingConnect:p,listTable:C,setListTable:S,setIsLoadingCountRows:v,selectedTable:y,setSelectedTable:j,downloadProgress:T,isLoadingBackup:w,detailContent:u};return s.createElement(s.Fragment,null,s.createElement(o.Z,{show:t,onHide:function(){j([]),a(!1),f(!0),i({}),S([])},backdrop:"static",style:{width:"60%"}},s.createElement(o.Z.Header,{closeButton:!0},s.createElement(o.Z.Title,null,"Backup Database ["," ",s.createElement("span",{className:"text-danger"},c.parseObject(u,"hostname"),"@",c.parseObject(u,"database"))," ","]")),s.createElement(o.Z.Body,null,s.createElement(s.Suspense,{fallback:c.lazyLoadFile()},s.createElement(r,H))),!h&&c.arrLength(y)&&s.createElement("div",{className:"offcanvas-footer"},c.buttons("Backup database",w,{onClick:function(){return w?null:D()}}))))}}}]);