"use strict";(self.webpackChunkdb_recovery=self.webpackChunkdb_recovery||[]).push([[51],{51:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8152),s=a(7294),o=a(3760),r=a(7463),c=s.lazy((function(){return a.e(809).then(a.bind(a,809))}));const i=function(e){var t=e.openFormsBackup,a=e.setOpenFormsBackup,i=e.detailContent,u=e.setDetailContent,l=(0,s.useState)(!0),d=(0,n.Z)(l,2),p=d[0],f=d[1],b=(0,s.useState)(!0),m=(0,n.Z)(b,2),h=m[0],v=m[1],g=(0,s.useState)(!1),k=(0,n.Z)(g,2),w=k[0],E=k[1],Z=(0,s.useState)([]),_=(0,n.Z)(Z,2),B=_[0],C=_[1],S=(0,s.useState)([]),L=(0,n.Z)(S,2),y=L[0],j=L[1],F=(0,s.useState)({}),O=(0,n.Z)(F,2),T=O[0],x=O[1];(0,s.useEffect)((function(){return r.objLength(i)&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(!0),r.post("/connecttodb",e,{},!0).then((function(e){var t=e.data;C(t)})).catch((function(e){r.notification(!1,r.error_code_http(e.response.status),e.code)})).then((function(){f(!1)}))}(i),function(){}}),[i]);var z=function(e){return B.findIndex((function(t){return t.tablename===e}))},D=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(void 0!==y[t]){E(!0);var n={hostname:i.hostname,username:i.username,password:i.password,database:i.database,dbdriver:i.dbdriver,port:i.port,tablename:y[t],page:a,total_row:B[z(y[t])].count};r.post("/handlebackup",n,{},!0).then((function(n){var s=n.data;if(s.status)if(s.next_row)x({tablename:y[t],progress:(1e3*a/B[z(y[t])].count*100).toFixed(0)}),e(t,a+1);else{var o=[];B.map((function(e){e.tablename===y[t]?o.push(Object.assign(e,{status:"complete"})):o.push(e)})),C(o),e(t+1,0)}else{var c=[];B.map((function(e){e.tablename===y[t]?c.push(Object.assign(e,{status:"fail"})):c.push(e)})),C(c),e(t+1,0),r.notification(!1,s.msg_response)}})).catch((function(n){r.notification(!1,r.error_code_http(n.response.status),n.code),e(t,a)}))}else x({}),E(!1),j([]),r.notification(!0,"Backup database selesai dilakukan.")},H={isLoadingConnect:p,listTable:B,setListTable:C,setIsLoadingCountRows:v,selectedTable:y,setSelectedTable:j,downloadProgress:T,isLoadingBackup:w,detailContent:i};return s.createElement(s.Fragment,null,s.createElement(o.Z,{show:t,onHide:function(){j([]),a(!1),f(!0),u({}),C([])},backdrop:"static",style:{width:"60%"}},s.createElement(o.Z.Header,{closeButton:!0},s.createElement(o.Z.Title,null,"Backup Database ["," ",s.createElement("span",{className:"text-danger"},r.parseObject(i,"hostname"),"@",r.parseObject(i,"database"))," ","]")),s.createElement(o.Z.Body,null,s.createElement(s.Suspense,{fallback:r.lazyLoadFile()},s.createElement(c,H))),!h&&r.arrLength(y)&&s.createElement("div",{className:"offcanvas-footer"},r.buttons("Backup database",w,{onClick:function(){return w?null:D()}}))))}}}]);